\documentclass[10pt,a4paper]{report}
\usepackage[top=3cm, bottom=2.5cm, left=3cm, right=2.5cm] {geometry}
\usepackage {bsymb,b2latex}
\usepackage[utf8]{inputenc}
\usepackage{fancyhdr,lastpage,color}
\lhead{\rm An Event-B Specification of BaseLiftMachine}
\rhead {\rm Page \thepage~of \pageref{LastPage}}
\lfoot{}\cfoot{}\rfoot{}
\pagestyle{fancy}
%---------------------------------------------------------
\begin{document}
\thispagestyle{empty}
\begin{description}
\BTitle{BaseLiftMachine}{20Sep2016}{01:37:43 AM}
\MACHINE{BaseLiftMachine}
\SEES{BaseLiftContext}
\VARIABLES
	\begin{description}
		\ItemY{ lift\_states }{Repesents the mapping between the lift and what the lift is actually doing (E.g. Stopped to let people out and in)}
		\ItemY{ lift\_movement\_directions }{The mapping between the lift and the direction that the lift is currently moving in}
		\ItemY{ lift\_current\_floor }{The mapping between lifts and which floor the lift is currently on}
		\Item{ total\_distance\_travelled }
		\Item{ total\_distance\_travelled\_per\_lift }
	\end{description}
\INVARIANTS
	\begin{description}
		\nItem{ inv1 }{ lift\_states \in  LIFTS \tfun  LIFT\_STATES }
		\nItem{ inv2 }{ lift\_movement\_directions \in  LIFTS \tfun  LIFT\_DIRECTIONS }
		\nItem{ inv3 }{ lift\_current\_floor \in  LIFTS \tfun  FLOORS }
		\nItem{ inv4 }{ total\_distance\_travelled \in  \nat  }
		\nItem{ inv5 }{ total\_distance\_travelled\_per\_lift \in  LIFTS \tfun  \nat  }
	\end{description}
\EVENTS
	\INITIALISATION
		\begin{description}
		\BeginAct
			\begin{description}
			\nItem{ act1 }{ lift\_states :=  LIFTS \cprod  \{ IDLE\}  }
			\nItem{ act2 }{ lift\_movement\_directions :=  LIFTS \cprod  \{ UP\}  }
			\nItem{ act3 }{ lift\_current\_floor :=  LIFTS \cprod  \{ 0\}  }
			\nItem{ act12 }{ total\_distance\_travelled :=  0 }
			\nItem{ act13 }{ total\_distance\_travelled\_per\_lift :=  LIFTS \cprod  \{ 0\}  }
			\end{description}
		\EndAct
		\end{description}
	\EVT {activate\_lift}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift\_states(lift) = IDLE }
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_states(lift) :=  STOPPED }
			\end{description}
		\EndAct
		\end{description}
	\EVT {deactivate\_lift}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift\_states(lift) = STOPPED }
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_states(lift) :=  IDLE }
			\end{description}
		\EndAct
		\end{description}
	\EVT {start\_lift}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift\_states(lift) = STOPPED }
			\nItem{ grd2 }{ lift\_movement\_directions(lift) = UP \limp  lift\_current\_floor(lift) <  TOP\_FLOOR }
			\nItem{ grd3 }{ lift\_movement\_directions(lift) = DOWN \limp  lift\_current\_floor(lift) >  0 }
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_states(lift) :=  MOVING }
			\end{description}
		\EndAct
		\end{description}
	\EVT {stop\_lift}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift\_states(lift) = MOVING }
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_states(lift) :=  STOPPED }
			\end{description}
		\EndAct
		\end{description}
	\EVT {move\_lift}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift\_states(lift) = MOVING }
			\nItem{ grd4 }{ 0 \leq  lift\_current\_floor(lift) + \{ UP \mapsto  1, DOWN \mapsto  - 1\} (lift\_movement\_directions(lift)) }
			\nItem{ grd5 }{ TOP\_FLOOR \geq  lift\_current\_floor(lift) + \{ UP \mapsto  1, DOWN \mapsto  - 1\} (lift\_movement\_directions(lift)) }
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_current\_floor(lift) :=  lift\_current\_floor(lift) + \{ UP \mapsto  1, DOWN \mapsto  - 1\} (lift\_movement\_directions(lift)) }
			\nItem{ act2 }{ total\_distance\_travelled :=  total\_distance\_travelled + 1 }
			\nItem{ act3 }{ total\_distance\_travelled\_per\_lift(lift) :=  total\_distance\_travelled\_per\_lift(lift) + 1 }
			\end{description}
		\EndAct
		\end{description}
	\EVT {change\_lift\_direction}
		\begin{description}
		\AnyPrm
			\begin{description}
			\Item{lift }
			\end{description}
		\WhereGrd
			\begin{description}
			\nItem{ grd1 }{ lift \in  LIFTS }
			\nItem{ grd2 }{ lift\_states(lift) \neq  MOVING }
			\nItemY{ grd3 }{ lift\_movement\_directions(lift) \neq  DOWN \limp  lift\_current\_floor(lift) >  0 }{		\\\hspace*{1.4 cm}  Lift cannot change direction to down if already on the bottom floor } 
			\nItemY{ grd4 }{ lift\_movement\_directions(lift) \neq  UP \limp  lift\_current\_floor(lift) <  TOP\_FLOOR }{		\\\hspace*{1.4 cm}  Lift cannot change direction to up if already on the top floor } 
			\end{description}
		\ThenAct
			\begin{description}
			\nItem{ act1 }{ lift\_movement\_directions(lift) :=  \{ UP \mapsto  DOWN, DOWN \mapsto  UP\} (lift\_movement\_directions(lift)) }
			\end{description}
		\EndAct
		\end{description}
\END
\end{description}
\end{document}
